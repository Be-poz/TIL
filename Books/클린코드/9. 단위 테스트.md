# 9. 단위 테스트

### TDD 법칙 세 가지

1. 실패하는 단위 테스트를 작성할 때까지 실제 코드를 작성하지 않는다.
2. 컴파일은 실패하지 않으면서 실행이 실패하는 정도로만 단위 테스트를 작성한다.
3. 현재 실패하는 테스트를 통과할 정도로만 실제 코드를 작성한다.

<br/>

### 깨끗한 테스트 코드 유지하기

실제 코드가 진화하면 테스트 코드도 변화해야 한다. 즉 테스트 코드도 유지보수를 해야하기 때문에 깨끗한 테스트 코드를 유지해야 한다. 테스트 케이스가 없으면 실제 코드를 유연하게 만드는 버팀목도 사라지기 때문에, 테스트 케이스는 필수적이다.  

테스트는 유연성, 유지보수성, 재사용성을 제공한다.  

<br/>

### 깨끗한 테스트 코드

깨끗한 테스트 코드를 위해서는 가독성이 굉장히 중요하다.  

각 테스트는 세 부분으로 나눈다. 첫 부분은 테스트 자료를 만들고, 두 번째는 테스트 자료를 조작하며, 세 번째 부분은 조작한 결과가 올바른지 확인하는 것이다. 잡다하고 세세한 코드를 다 없애고 진짜 필요한 자료 유형과 함수만 사용한다. 읽을 때에 코드가 수행하는 기능을 재빨리 이해하도록 말이다. 시스템 조작 API를 사용하는 대신 API 위에다 함수오 유틸리티를 구현한 후 그 함수와 유틸리티를 사용하여 테스트 코드를 짜기도 읽기도 쉽게한다.  

테스트 코드는 단순하고, 간결하고, 표현력이 풍부해야 ㅎ지만, 실제 코드만큼 효율적일 필요는 없다.  

<br/>

### 테스트 당 assert 하나

테스트 당 assert 문이 하나면 이해하기가 더 수월하다. 또는 **테스트 함수마다 한 개념만 테스트 하라** 가 더 낫겠다.  

<br/>

### F.I.R.S.T

깨끗한 테스트는 다섯 가지 규칙을 따른다.  

* Fast : 테스트는 빨라야 한다.  
* Independen : 각 테스트는 서로 의존하면 안 된다. 한 테스트가 다음 테스트가 실행될 환경을 준비해서는 안 된다. 테스트가 서로에게 의존하면 하나가 실패할 때 나머지도 잇달아 실패하므로 언인을 진단하기 어려워지며 후반 테스트가 찾아내야 할 결함이 숨겨진다.
* Repeatable : 테스트는 어떤 환경에서도 반복 가능해야 한다.
* Self - Validating : 테스트는 bool 값으로 결과를 내야 한다. 성공 아니면 실패다. 통과 여부를 알력 ㅗ로그 파일을 읽게 만들어서는 안 된다.
* Timely : 테스트는 적시에 작성해야 한다. 단위 테스트는 테스트하려는 실제 코드를 구현하기 직전에 구현한다. 실제 코드를 구현한 다음에 테스트 코드를 만들면 실제 코드가 테스트하기 어려울 수 있다. 테스트가 불가능하도록 실제 코드를 설계할지도 모른다.

<br/>

### 결론

테스트 코드는 실제 코드의 유연성, 유지보수성, 재사용성을 보존하고 강화하기 때문에 실제 코드보다 더 중요할 수도 있다. 테스트 API를 구현해 도메인 특화 언어를 만들자. 그러면 그만큼 테스트 코드를 짜기가 쉬워진다. 테스트 코드가 방치되어 망가지면 실제 코드도 망가진다. 테스트 코드를 깨끗하게 유지하자.  

***