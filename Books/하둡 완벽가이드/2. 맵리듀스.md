# 맵리듀스

맵리듀스는 데이터 처리를 위한 프로그래밍 모델이다.  하둡은 다양한 언어로 작성된 맵리듀스 프로그램을 구동시킬 수 있다.  
맵리듀스는 태생 자체가 병행성을 고려하여 설계되었고, 누구든지 충분한 장비만 갖추고 있다면 대규모 데이터 분석을 할 수 있다.  

<br/>

## 하둡으로 데이터 분석하기

하둡이 제공하는 병렬 처리의 이점을 이용하기 위해서는 우리 요구사항을 맵리듀스 잡으로 다시 표현할 필요가 있다.  

### 맵과 리듀스

맵리듀스 작업은 크게 맵 단계와 리듀스 단계로 구분된다. 각 단계는 입력과 출력으로 키-값의 쌍을 가지며, 그 타입은 프로그래머가 선택한다. 또한 프로그래머는 맵 함수와 리듀스 함수를 작성해야 한다.  

데이터는 국립기후자료센터의 기후 데이터를 기반으로 예를 들어 말해본다. 먼저 데이터셋의 각 행의 타입을 텍스트로 인식하는 텍스트 입력 포맷을 선택한다. 값은 각 행이고, 키는 파일의 시작부에서 각 행이 시작되는 지점까지의 오프셋이다.  

맵 함수는 데이터의 준비 단계로, 연도별 최고 기온을 찾는 리듀스 함수를 위해 데이터를 제공하는 역할을 맡는다.  
또한 잘못된 레코드를 걸러주는 작업은 맵 함수에서 수행하는 것이 적합하며, 여기서는 기온 필드의 값이 누락되거나 이상하거나 문제가 있는 레코드를 제거하는 작업을 수행한다.  

```
0006701....
004301.....

있으면

(0, 006701...)    	각 행이 시작되는 지점까지의 오프셋, 각 행
(106, 004301...)
```

맵 함수는 연도와 기온을 추출하여 출력으로 내보낸다.  

```
(1950, 0)
(1950, 22)
(1950, -11)
...
```

맵 함수의 출력이 리듀스 함수의 입력으로 보내지는 과정은 맵리듀스 프레임워크에 의해 처리된다.  
이 과정에서 키-값 쌍은 키를 기준으로 정렬되고 그룹화된다. 여기서 키는 연도고 값은 기온이다.  

```
(1949, [111, 78])
(1950, [0, 22, -11])
```

연도별로 측정된 모든 기온갑싱 하나의 리스트로 묶인다. 리듀스 함수는 리스트 전체를 반복하여 최고 측정값을 추출한다.

```
(1949, 111)
(1950, 22)
```

<img width="720" alt="image" src="https://github.com/Be-poz/TIL/assets/45073750/91822e41-bf3b-4f21-bbb4-ebef178b6b5d">

### 자바 맵리듀스

