# 코틀린 타입 시스템

## 널 가능성

### 널이 될 수 있는 타입

```java
int strLen(String s) {
  return s.length();
}
```

위의 자바 코든는 null 가능성이 있다.  
코틀린에서는 널과 문자열을 인자로 받을 수 있게 하려면 타입 이름 뒤에 물음표(?)를 명시해야한다.  

```kotlin
fun strLenSafe(str: String?) = if(str != null) str.length else 0
```

```kotlin
val x: String? = null
val y: String = null	// error
```

<Br/>

### 안전한 호출 연산자: ?.  /  엘비스 연산자: ?:

``?.``는 null 검사와 메서드 호출을 한 번의 연산으로 수행한다. null이면 호출이 무시되고 null이 아니면 정상 호출된다.  
``?:``는 null 대신 사용할 디폴트 값을 지정할 때 편리하게 사용할 수 있는 연산자다.  

```kotlin
fun strLenSafe(str: String?) = str?.length ?: 0
```

if문을 이용했던 코드를 ``?.``를 ``?:``를 이용하여 표현할 수가 있다.  

```kotlin
val address = person.company?.address
														?: throw IllegalArgumentException("No address")
```

엘비스 연산자를 이용하여 디폴트 값 뿐만이 아니라 예외까지 발생시킬 수 있다.  

<br/>

### 안전한 캐스트:  as?  /  널 아님 단언: !!

``as?`` 연산자는 어떤 값을 지정한 타입으로 캐스트하고 변환할 수 없다면 null을 반환한다.  

```kotlin
class Person(val firstName: String, val lastName: String) {
    override fun equals(o: Any?): Boolean {
        val otherPerson = o as? Person ?: return false

        return otherPerson.firstName == firstName &&
                otherPerson.lastName == lastName
    }
}
```

위와 같이 캐스트를 할 수 없다면 엘비스 연산자와 연계해서 false를 리턴하게끔 하였다.  

```kotlin
fun ignoreNulls(s: String?) {
  val sNotNull: String = s!!
  println(sNotNull.length)
}
```

널 아님 단언 ``!!``는 컴파일러에게 이 값이 null이 아님을 알려주기 위한 연산자다. 예외가 발생해도 감수하겠다는 뜻이다.  

!!를 널에 대해 사용해서 발생하는 예외의 스택 트레이스에는 어떤 파일의 몇 번째 줄인지에 대한 정보는 들어있지만 어떤 식에서 예외가 발생했는지에 대한 정보는 들어있지 않다. 어떤 값이 널이었는지 확실히 하기 위해 여러 !! 단언문을 한 줄에 함께 쓰는 일을 피해야 한다. ``person.company!!.address!!.country`` 이런 코드 말이다.  

<Br/>

### let 함수

let 함수는 널이 아닌 경우에만 호출된다.  

```kotlin
fun sendEmailTo(email: String) {
  println("Sending email to $email")
}

var email: String? = "hi@bepoz.com"
email?.let { sendEmailTo(it) }

var email: String? = null
email?.let { sendEmailTo(it) }  // 실행 X
```

<br/>

### 나중에 초기화할 프로퍼티

