# 1. 엘라스틱 스택 개요

검색 엔진은 내부적으로 각 도큐먼트를 인덱싱하고 빠르게 검색하는 데 사용하는 기술이다.  

엘라스틱서치는 모든 레코드를 JSON 도큐먼트 형태로 입력하고 관리하고 있으며, 일반적인 데이터베이스와 마찬가지로, 쿼리한 결과에 대해 일치하는 원본 도큐먼트를 반환한다. 엘라스틱 서치는 텍스트 외에도 숫자, 날짜, IP 주소, 지리 정보 등 다양한 데이터 타입에 대해 최적화되어 있다. 검색 엔진이면서 데이터베이스이기도 화고 텍스트 외에 다양한 데이터 타입을 지원한다는 점에서 일종의 NoSQL 데이터베이스라고 생각하면 될 것이다.  

엘라스틱서치는 텍스트나 도큐먼트의 경우 인덱싱 시점에 분석을 거쳐 용어 단위로 분해되고 역인덱스 사전을 구축한다.  

중요한 특징 중 하나는 스코어링, 즉 연관도에 따른 정렬이다. 단순히 필드값을 기준으로 한 정렬이 아니라 검색어에 대한 유사도 스코어를 기반으로 한 정렬을 제공한다. 

저장공간이 크게 압축되지 않고 시스템 리소스를 많이 사용한다는 단점이 있다.  
DSL(Domain Specific Language) 쿼리를 채용하는데 JOIN 쿼리가 사실상 어렵기 때문에 반정규화를 기본으로 모델링해야 한다. 또한 인덱스가 불변의 자료구조이기 때문에 도큐먼트를 수정하거나 삭제할 경우에 비용이 저렴하지 않다. 하지만 이러한 단점들은 검색 성능을 끌어올리기 위해 어느 정도 트레이드오프가 이뤄진 것으로, 엘라스틱 서치가 필요한 수준의 대량 데이터를 처리할 때는 일반적으로 용인되는 제약들이다.  

엘라스틱서치는 사용자의 모든 입력을 REST API 형태로 받아들이기 때문에 curl 명령 등 친숙한 도구들을 이용해 기능을 활용할 수 있다. 하지만 복잡한 요청으르 일일이 작성하기에는 다소 불편할 수 있다. 키바나는 이런 불편함을 해소해준다. UI를 담당한다. 특히 라인 차트, 파이 차트 등과 테이블, 지도 등의 다양한 시각화 요소들을 클릭 몇 번으로 쉽게 구성할 수 있게 해준다. 특히 시각화 요소들을 한 화면에 마음대로 배치하고 실시간으로 업데이트할 수 있는 대시보드 기능을 엘라스틱 스택의 확산과 보급에 지대한 공헌을 했다.  

로그 스태시를 사용하면 로그, 메트릭, 웹 애플리케이션 등 다양한 소스로부터 로그를 수집할 수 있다. 또한 필터 기능을 이용해 비정형이나 반정형 데이터를 분석하기 쉬운 형태로 정제할 수 있고 엘라스틱서치 외에도 다양한 플랫폼으로 정제된 데이터를 내보낼 수 있다.  

실제 서비스가 동작하는 호스트에 수집기를 설치해야 하는 경우가 많은데 로그스태시는 다양한 필터와 설정을 지원하는 만큼 무거워 활용도가 떨어질 수 있다. 엘라스틱 스택에는 이를 위해 파일비트, 메트릭비트 등 비츠라고 부르는 경략 수집기가 포함되어 있다. 각 비트는 로그 수집, 시스템 지표 수집 등 특정 목적에 최적화된 에이전트다. 로그스태시 수준의 복잡한 이벤트 가공은 지원하지 않아 가벼우므로, 각 서비스 호스트에 비교적 부담 없이 설치할 수 있다. 이러한 양쪽의 장점을 활용하기 위해 비츠와 로그스태시를 혼합해 많이 사용한다.  
***
